<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
<link rel="stylesheet" type="text/css" href="/css/mappage.css">
<script type="text/javascript"
	src="http://maps.googleapis.com/maps/api/js?key={{ GOOGLE_MAPS_KEY }}&sensor=false">
    </script>

<script type="text/javascript"
	src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js">
    </script>

<script type="text/javascript">
    function updateFormDate(map){
    	$("#map_center").text(map.getCenter());
    	$("#zoom").attr("value", map.getZoom());
     }
      function initialize() {
        var myOptions = {
          center: new google.maps.LatLng(8.9, -80.2),
          zoom: 8,
          mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        var map = new google.maps.Map(document.getElementById("map_canvas"),
            myOptions);
      
        google.maps.event.addListener(map, 'center_changed', function() {
            // 3 seconds after the center of the map has changed, pan back to the
            // marker.
            window.setTimeout(function() {
            	updateFormDate(map)
            	
            }, 1000);
          });
        google.maps.event.addListener(map, 'bounds_changed', function() {
            // 3 seconds after the center of the map has changed, pan back to the
            // marker.
            window.setTimeout(function() {
            	updateFormDate(map)
            	
            }, 1000);
          });
        google.maps.event.addListener(map, 'click', function(event) {
            placeMarker(event.latLng);
          });
        updateFormDate(map)
      }   
        function placeMarker(location) {
      	  var marker = new google.maps.Marker({
      	      position: location,
      	      map: map
      	  });
      }
                
 
      //$(document).ready(function() {
      //    $("#map_center").text("JQuery loaded")
      //}
     
    </script>
</head>
<body onload="initialize()">
	<h1>{{ title }}</h1>
	<div id="map_canvas" ></div>
	<div id="map_info">
			Center: <span id="map_center">Center</span> <br/>
			Zoom: <span id="map_zoom">Zoom</span> <br/>
			<form action="save_location" method="post">
				<label for="name" class="loc-labels">Name:</label>
				<input id="name" type="text"><br/>
				<label for="latitude" class="loc-labels">Latitude:</label>
				<input id="latitude" type="text"><br/>
				<label for="longitude" class="loc-labels">Longitude:</label>
				<input id="longitude" type="text"><br/>
				<label for="zoom" class="loc-labels">Zoom:</label>
				<input id="zoom" type="text"><br/>
				<div><input type="submit" value="Save Location"></div>
			</form>
	</div>
</body>
</html>